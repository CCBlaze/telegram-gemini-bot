<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>FusionGPT üí° - –í–µ–±-—á–∞—Ç</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .chat-container { background-color: white; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); width: 400px; height: 600px; display: flex; flex-direction: column; }
        .chat-header { padding: 15px; background-color: #007bff; color: white; border-top-left-radius: 10px; border-top-right-radius: 10px; text-align: center; }
        .chat-messages { flex-grow: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; }
        .message { margin-bottom: 10px; padding: 8px 12px; border-radius: 15px; max-width: 80%; }
        .user-message { align-self: flex-end; background-color: #dcf8c6; }
        .ai-message { align-self: flex-start; background-color: #e6e6e6; }
        .chat-input { display: flex; padding: 10px; border-top: 1px solid #ddd; }
        .chat-input input { flex-grow: 1; padding: 10px; border: 1px solid #ccc; border-radius: 20px; margin-right: 10px; }
        .chat-input button { padding: 10px 15px; border: none; background-color: #007bff; color: white; border-radius: 20px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">FusionGPT üí°</div>
        <div id="chatbox" class="chat-messages">
            <div class="message ai-message">–ü—Ä–∏–≤–µ—Ç! –Ø FusionGPT, –∑–∞–¥–∞–π—Ç–µ –º–Ω–µ –≤–æ–ø—Ä–æ—Å!</div>
        </div>
        <div class="chat-input">
            <input type="text" id="userInput" placeholder="–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
            <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <script>
        function sendMessage() {
            const inputField = document.getElementById('userInput');
            const userText = inputField.value;
            if (userText === '') return;

            const chatbox = document.getElementById('chatbox');
            
            // 1. –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userMsg = document.createElement('div');
            userMsg.className = 'message user-message';
            userMsg.textContent = userText;
            chatbox.appendChild(userMsg);
            
            // 2. –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–∞–≥–ª—É—à–∫—É –¥–ª—è –ò–ò
            const loadingMsg = document.createElement('div');
            loadingMsg.className = 'message ai-message';
            loadingMsg.textContent = 'FusionGPT –ø–µ—á–∞—Ç–∞–µ—Ç...';
            chatbox.appendChild(loadingMsg);
            chatbox.scrollTop = chatbox.scrollHeight; // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑

            inputField.value = ''; // –û—á–∏—Å—Ç–∏—Ç—å –≤–≤–æ–¥

            // 3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä Flask
            fetch('/api/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ message: userText })
            })
            .then(response => response.json())
            .then(data => {
                // 4. –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ò–ò
                loadingMsg.textContent = data.response;
                loadingMsg.className = 'message ai-message'; // –£–±—Ä–∞—Ç—å "–ø–µ—á–∞—Ç–∞–µ—Ç"
                chatbox.scrollTop = chatbox.scrollHeight;
            })
            .catch(error => {
                loadingMsg.textContent = '–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.';
                console.error('Fetch error:', error);
            });
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ Enter
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>